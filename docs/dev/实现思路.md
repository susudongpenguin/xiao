# 页面及组件实现思路

## 可执行命令

### 启动开发服务器 / 预览

npm run serve

### 构建生产环境版本

npm run build

## 全局注入 js / css

位于 `public/inject` 下的文件都会按分类进行注入，对于单独注入的页面则是通过对应路径名字进行注入

比如 `about` 页面，需要注入页面的文件要这样放在文件夹下：`public/inject/about/`

通过钩子进行注入，css 同理

## 全局静态资源

全部放在 public 目录下，这种引入方式是最好的

文档：https://docs.astro.build/zh-cn/migrate/#%E5%A6%82%E4%BD%95%E8%A7%A3%E6%9E%90%E5%9B%BE%E5%83%8F%E5%92%8C%E5%85%B6%E4%BB%96%E8%B5%84%E6%BA%90

## 全局组件与变量

### 个人信息

在 `blog.config.ts` 进行设置，基本信息结构：

```js
UserInfo = {
  name: '',
  introduction: '',
  avatar: '',
  link: [
    {
      tip: 'Github',
      link: '',
      class: 'iconfont iconfont-Github'
    }
  ]
}
```

外链部分是从预设进行选取，从 iconfont 下载字体，然后通过类名去设置，自己注入的话则是在全局进行设置

这个信息将会全局共享，包括归档页，文章页，关于页面

组件的话有两种布局模式：横向和竖向

横向是用在文章页和关于页面，竖向是用在归档页

### 近期文章

执行 build 命令时遍历所有的文章，读取时间排序

直接生成静态 html 注入需要用的页面

独立成组件，内部通过 `Astro` 全局 API 进行读取

### 搜索功能

执行 build 的时候生成一份 json 的文件，包含所有文章的信息

目前设想是处于 Nodejs 下可用，其他暂时不可用

内置的实现方式：基于中间件模式，在 express 下设置接口，然后读取 json 进行搜索，并返回相关内容

在 utils 下设置一个方法，用于捆绑 js 方法

运行时 API: https://docs.astro.build/zh-cn/reference/integrations-reference/

在 `astro:build:start` 这个钩子对文章进行处理，转换成 json 文件，进行 nodejs 改写

使用 vue 编写搜索组件，当配置中搜索功能启用的时候需要对请求地址进行指定

搜索会注入在 header ，期望的搜索组件是只有在按下搜索按钮时才进行真实 DOM 渲染

具体看这篇文章：https://paugram.com/coding/simple-drawer-react-component.html

### Header

分两个状态：页面位于头部 / 页面滚动后

标题：

1. 头部状态：展示博客名字与跳转选择
2. 中间状态：当前位置 + 博客名字

### Footer

可以在 config 文件进行配置：

```js
footer = {
  content: [
    '© 2022-Present Shiina',
    '<div>Powered by Astro + Vue</div>'
  ]
}
```

content 内容会全部注入到 footer 部分，footer 外围本身用 flex + center 的方式进行内容居中

或者自行配置 HTML / Astro 组件，在 `CustomPage/footer` 下基于中间件 `index.astro` 组件，并将自己的内容引入就会将原生的所有内容进行替代

## 页面实现思路

### 通用

正文部分背景：纯色，用于衬托文字，也有可能是稍透明 + 背景毛玻璃处理

底层背景：纯色或背景图 + js 效果

层级关系如下：

1. js 效果
2. 纯色
3. 背景图

背景图是固定定位，铺满全屏的图片

如果需要自定义 HTML 的话我们需要用户自行新建组件，并通过桥接组件与博客本体对接

主题模式切换：白天 / 晚上

通过全局 css 变量处理

目前想法是有四个颜色可以处理：

- 默认背景颜色，用于一般背景
- 激活时背景颜色，比如一个可选框鼠标悬浮时展示的背景颜色
- 默认文字颜色
- 激活时文字颜色，比如 a 标签鼠标悬浮时的变换的颜色

### 首页

推荐是使用者自行制作，他是一个 astro 组件，即 `CustomPage/index/index.astro`

其会被直接插入到 body 中间，html 的话则是 100% 宽高的容器

如果没有的话我们则是提供两套预设页面，第一套着重于信息，第二套突出简洁感

自定义时需要一个中间件桥接，由使用者自行改造，用于承载页面自定义页面

自己写的两个主题就作为示例放在里面

### 博客 / 归档

两种布局模式，第一种是传统模式，即普通的列表

第二种是归档模式，即时间线列表

两种模式做成两个独立页面，因为这样子第一个页面加载时间能少一些，不需要额外处理 js

### 标签

可能需要自己实现一个 tag 算法，影响到词的大小与透明度

可以基于 vue 实现

词的出现次数越多则词越大，越不透明

用户可以自定义颜色，以适配背景

### 友链

在 config 设置即可，数据结构如下：

### 关于我

在 config 设置自己的信息

然后用户可以添加自定义模块，用来展示自己的项目信息

自定义模块分列表的和带图展示两种

模块可以通过全局 config 设置

### 其他页面

通过中间件进行桥接进入，或者让用户将组件自行摆在某个文件夹下，然后生成的时候程序进行遍历文件

建议是通过框架制作自定义页面，如果是生成好的静态页面可能存在资源需要手动处理路径问题的原因

### 文章页面

使用 vue 处理右侧目录变化

当然也可以使用轻量一点的框架比如 preact 或 pvue 处理

Front-Matter:
```markdown
<!-- 这里是 front matter，支持以下参数 -->
---
<!-- 文章标题 -->
title: Hello World
<!-- 创建日期 -->
date: 2022/12/09 11:45:14
<!-- 更新日期(可选) -->
updated: 2022/12/10 11:45:14
<!-- 标签(可选) -->
tags: [前端,Astro]
<!-- 分类(可选) -->
categories: 技术
---
```

